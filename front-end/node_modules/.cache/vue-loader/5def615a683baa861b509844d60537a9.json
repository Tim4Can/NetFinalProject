{"remainingRequest":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\src\\views\\counseling\\MyReservation.vue?vue&type=style&index=0&id=3e69e710&lang=less&scoped=true&","dependencies":[{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\src\\views\\counseling\\MyReservation.vue","mtime":1589903405526},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\less-loader\\dist\\cjs.js","mtime":1590575508597},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n@import '~ant-design-vue/lib/style/themes/default.less';\r\n.button-group {\r\n  margin-bottom: 1rem;\r\n  .button {\r\n    margin-left: 0.5rem;\r\n    margin-left: 0.5rem;\r\n  }\r\n}\r\n",{"version":3,"sources":["MyReservation.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MyReservation.vue","sourceRoot":"src/views/counseling","sourcesContent":["<template>\r\n  <page-view title=\"我的预约\">\r\n    <a-card>\r\n      <template>\r\n        <a-table :columns=\"columns\" :dataSource=\"rDataShow\" rowKey=\"id\">\r\n          <template\r\n              v-for=\"col in ['teacher', 'time', 'address']\"\r\n              :slot=\"col\"\r\n              slot-scope=\"text\"\r\n            >\r\n            <div :key=\"col\">{{ text }}</div>\r\n          </template>\r\n          <template slot=\"operation\" slot-scope=\"text, record\">\r\n            <a-button\r\n              size=\"small\"\r\n              type=\"danger\"\r\n              :hidden='text'\r\n              @click=\"onClickDelete(record.reservation.id)\"\r\n            >取消预约\r\n            </a-button>\r\n            <a-modal\r\n              title=\"确认取消\"\r\n              v-model=\"visible2\"\r\n              @ok=\"onClickDeleteRow\"\r\n            >\r\n              <div class=\"modal\">\r\n                是否取消本次预约\r\n              </div>\r\n            </a-modal>\r\n          </template>\r\n        </a-table>\r\n      </template>\r\n    </a-card>\r\n  </page-view>\r\n</template>\r\n\r\n\r\n<script>\r\nimport Fuse from 'fuse.js'\r\nimport Vue from 'vue'\r\nimport { getMyReserve, cancelAppointment } from '@/api/counseling'\r\nimport Lightbox from 'vue-easy-lightbox'\r\nimport { PageView } from '@/layouts'\r\nVue.use(Lightbox)\r\n\r\nconst columns = [\r\n  {\r\n    title: '老师姓名',\r\n    dataIndex: 'teacher',\r\n   //width: '15%',\r\n    align: 'center',\r\n    scopedSlots: { customRender: 'teacher' },\r\n  },\r\n  {\r\n    title: '预约时间',\r\n    dataIndex: 'time',\r\n    align: 'center',\r\n    width: '18%',\r\n    scopedSlots: { customRender: 'time' },\r\n    sorter: (a, b) => a.reserveTime > b.reserveTime\r\n  },\r\n  {\r\n    title: '预约地址',\r\n    dataIndex: 'address',\r\n    align: 'center',\r\n    width: '30%',\r\n    scopedSlots: { customRender: 'address' }\r\n  },\r\n  {\r\n    titile: '操作',\r\n    align: 'center',\r\n    dataIndex: 'operation',\r\n    scopedSlots: { customRender: 'operation' }\r\n  },\r\n]\r\n\r\nconst rData=[]\r\nconst rDataShow=[]\r\n\r\nexport default {\r\n  name: 'myReservation',\r\n  inject: ['reload'],\r\n  components: {\r\n    PageView\r\n  },\r\n  data() {\r\n     return {\r\n        rData,\r\n        rDataShow,\r\n        deleteInfo:'',\r\n        columns,\r\n        current: 1,\r\n        totalPage:'',\r\n        visible2: false,\r\n        todelete:'',\r\n        form: this.$form.createForm(this)\r\n     };\r\n  },\r\n    computed:{\r\n        userInfo() {\r\n            return this.$store.getters.userInfo\r\n        }\r\n    },\r\n    created() {\r\n        this.user = this.userInfo\r\n    },\r\n  filters: {\r\n    statusFilter (type) {\r\n       return statusMap[type].text\r\n    },\r\n    statusTypeFilter (type) {\r\n       return statusMap[type].status\r\n    }\r\n  },\r\n  methods:{\r\n    onClickDeleteRow () {\r\n      this.visible2 = false;\r\n      const newData = [...this.rDataShow]\r\n      console.log(newData)\r\n      const target = newData.filter(item => this.todelete === item.id)[0]\r\n      console.log(target)\r\n\r\n      cancelAppointment({ id : target.id}).then((response) => {\r\n        this.deleteInfo = response.info\r\n        if(this.deleteInfo !== 'fail'){\r\n          this.rData = [...response.data]\r\n          this.rDataShow = this.rData\r\n        }\r\n        if(this.deleteInfo === 'ok'){\r\n          this.$notification.open({\r\n          message: '取消成功',\r\n          description: '本条预约取消成功',\r\n          icon: <a-icon type=\"check\" style=\"color: #108ee9\" />,\r\n        });\r\n        }\r\n        else{\r\n          this.$notification.open({\r\n          message: '取消失败',\r\n          description: '本条预约取消失败',\r\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\r\n        });\r\n        }\r\n        this.reload()\r\n      })\r\n      // to be complete\r\n      },\r\n      onClickRefresh(){\r\n        this.reload()\r\n      },\r\n      onClickDelete (id) {\r\n        console.log(id)\r\n        this.todelete = id\r\n        this.visible2 = true;\r\n      },\r\n      onChange(current){\r\n        this.current=current;\r\n        getMyReserve({'id':this.userInfo.id,'page':this.current-1}).then((response)=>{\r\n        console.log(response);\r\n        console.log(this.page);\r\n        this.rData=response.data;\r\n        this.rDataShow=this.rData.list;\r\n        this.totalPage=this.rData.page\r\n      })\r\n     }\r\n    },\r\n    mounted(){\r\n      console.log(\"my\")\r\n        //this.userInfo.id  this.current-1\r\n        console.log(this.userInfo.id);\r\n      getMyReserve({'id':this.userInfo.id,'page':this.current-1}).then((response)=>{\r\n        console.log(response);\r\n        console.log(this.page);\r\n        this.rData=response.data;\r\n        this.rDataShow=this.rData.list;\r\n        this.totalPage=this.rData.total\r\n      })\r\n    }\r\n  };\r\n\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '~ant-design-vue/lib/style/themes/default.less';\r\n.button-group {\r\n  margin-bottom: 1rem;\r\n  .button {\r\n    margin-left: 0.5rem;\r\n    margin-left: 0.5rem;\r\n  }\r\n}\r\n</style>\r\n"]}]}