{"remainingRequest":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\src\\views\\user\\MyPage.vue?vue&type=style&index=0&id=7458ed95&lang=less&scoped=true&","dependencies":[{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\src\\views\\user\\MyPage.vue","mtime":1589963567585},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\css-loader\\index.js","mtime":1589903383310},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1589903404207},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\postcss-loader\\src\\index.js","mtime":1589903395815},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\less-loader\\dist\\cjs.js","mtime":1589903392905},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1589903381409},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1589903404205}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.addButton{\r\n    position: absolute;\r\n    z-index: 999;\r\n    right:1em;\r\n    top:0em;\r\n  }\r\n",{"version":3,"sources":["MyPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoWA;AACA;AACA;AACA;AACA;AACA","file":"MyPage.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\r\n  <page-view :avatar=\"userInfo.headPortrait\" :title=\"false\">\r\n    <div slot=\"headerContent\">\r\n      <div class=\"title\">{{ timeFix }}，{{ user.name }}！</div>\r\n    </div>\r\n    <a-row :gutter=\"24\">\r\n      <!--个人信息-->\r\n        <a-col\r\n          style=\"padding: 0 12px\"\r\n          :xl=\"8\"\r\n          :lg=\"24\"\r\n          :md=\"24\"\r\n          :sm=\"24\"\r\n          :xs=\"24\">\r\n          <!--个人信息-->\r\n          <a-card\r\n            style=\"margin-bottom: 24px; margin-top: 0px\"\r\n            :bordered=\"false\"\r\n            title=\"个人信息\"\r\n            :body-style=\"{ padding: 0 }\">\r\n            <a-card>\r\n              <a-row style=\"margin-bottom: 12px\">\r\n                <a-icon type=\"idcard\" theme=\"twoTone\" twoToneColor=\"#3A5FCD\"/>\r\n                <strong> 学号：</strong>\r\n                {{ userInfo.id }}\r\n              </a-row>\r\n              <a-row style=\"margin-bottom: 12px\">\r\n                <a-icon type=\"tag\" theme=\"twoTone\" twoToneColor=\"#3A5FCD\"/>\r\n                <strong> 姓名：</strong>\r\n                {{ userInfo.name }}\r\n              </a-row>\r\n              <a-row style=\"margin-bottom: 12px\">\r\n                <a-icon type=\"tag\" theme=\"twoTone\" twoToneColor=\"#3A5FCD\"/>\r\n                <strong> 昵称：</strong>\r\n                {{ userInfo.nickName }}\r\n              </a-row>\r\n            </a-card>\r\n          </a-card>\r\n          <!--密码修改-->\r\n          <div>\r\n            <a-row style=\"text-align: center\">\r\n              <a-button @click=\"modifyPassButton\" type=\"primary\" icon=\"lock\"> 修改密码</a-button>\r\n              <a-modal v-model=\"showPasswordForm\" footer=\"\">\r\n                <a-form title=\"修改密码\" @submit=\"handleSubmit\" :form=\"form\">\r\n                  <a-form-item\r\n                    :wrapperCol=\"{ span: 24 }\"\r\n                    style=\"text-align: center\"\r\n                  >\r\n                    <h3>修改密码</h3>\r\n                  </a-form-item>\r\n                  <a-form-item\r\n                    label=\"旧密码\"\r\n                    :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n                    :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\">\r\n                    <a-input\r\n                      type=\"password\"\r\n                      v-decorator=\"[\r\n            'old_password',\r\n            {rules: [{ required: true, message: '请输入旧的密码' }]}\r\n          ]\"\r\n                      name=\"old_password\"\r\n                      placeholder=\"请输入旧的密码\"/>\r\n                  </a-form-item>\r\n                  <a-form-item\r\n                    label=\"新密码\"\r\n                    :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n                    :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\">\r\n                    <a-input\r\n                      type=\"password\"\r\n                      v-decorator=\"[\r\n            'new_password',\r\n            {rules: [{ required: true, message: '请输入新的密码' }]}\r\n          ]\"\r\n                      name=\"new_password\"\r\n                      placeholder=\"请输入新的密码\"/>\r\n                  </a-form-item>\r\n                  <a-form-item\r\n                    :wrapperCol=\"{ span: 24 }\"\r\n                    style=\"text-align: center\"\r\n                  >\r\n                    <a-button htmlType=\"submit\" type=\"primary\">提交</a-button>\r\n                    <a-button style=\"margin-left: 8px\" @click=\"cancelModifyPassword\">取消</a-button>\r\n                  </a-form-item>\r\n\r\n                </a-form>\r\n              </a-modal>\r\n            </a-row>\r\n          </div>\r\n        </a-col>\r\n      <a-col :xl=\"16\" :lg=\"24\" :md=\"24\" :sm=\"24\" :xs=\"24\">\r\n        <a-card\r\n          style=\"width:100%\"\r\n          :tabList=\"tabListNoTitle\"\r\n          :activeTabKey=\"noTitleKey\"\r\n          @tabChange=\"key => onTabChange(key, 'noTitleKey')\"\r\n        >\r\n      <template v-if=\"noTitleKey === '发帖'\">\r\n        <a-list :dataSource=\"postData\">\r\n          <a-list-item slot=\"renderItem\" slot-scope=\"item, index\">\r\n             <a slot=\"actions\" @click=\"onClickDelete(item.id)\">删除</a>\r\n             <a-modal\r\n                title=\"确认删除\"\r\n                :visible=\"visible3\"\r\n                @ok=\"onClickDeleteRow\"\r\n                @cancel=\"onClickCancel\"\r\n             >\r\n             <div class=\"modal\">\r\n                是否删除本条帖子\r\n             </div>\r\n             </a-modal>\r\n              <a-list-item-meta :title='item.title'>\r\n                <a-avatar\r\n                  width=\"72\"\r\n                  slot=\"avatar\"\r\n                  :src=\"item.headPortrait\"\r\n                />\r\n                <div slot=\"description\">\r\n                  <ellipsis :length=\"70\">{{ item.content }}</ellipsis>\r\n                </div>\r\n                <br/>\r\n                <div slot=\"description\">\r\n                  <ellipsis :length=\"70\">{{ item.sendTime }}</ellipsis>\r\n                </div>\r\n\r\n              </a-list-item-meta>\r\n              <div>\r\n                 <router-link :to=\"{ name: 'postDetail', params:{ id: item.id} }\">帖子详情</router-link>\r\n              </div>\r\n          </a-list-item>\r\n        </a-list>\r\n        <div style=\"margin-top:20px\">\r\n          <a-pagination @change=\"onChange1\" :current=\"current\" :total=\"(totalPage1+1)*10\" />\r\n        </div>\r\n      </template>\r\n      <template v-if=\"noTitleKey === '收藏'\">\r\n        <a-list :dataSource=\"likeData\">\r\n          <a-list-item>\r\n            <a-card :bordered=\"false\" style=\"width:100%\">\r\n              <a-card-meta title=\"item.title\">\r\n                <img style=\"width:100px\"\r\n                   slot=\"avatar\"\r\n                   :src=\"item.image\"\r\n                 />\r\n              </a-card-meta>\r\n            </a-card>\r\n          </a-list-item>\r\n        </a-list>\r\n        <div style=\"margin-top:20px\">\r\n          <a-pagination @change=\"onChange2\" :current=\"current\" :total=\"(totalPage2+1)*10\" />\r\n        </div>\r\n      </template>\r\n       </a-card>\r\n      </a-col>\r\n    </a-row>\r\n  </page-view>\r\n</template>\r\n\r\n<script>\r\nimport { STable } from '@/components'\r\nimport { PageView } from '@/layouts'\r\nimport Fuse from 'fuse.js'\r\nimport md5 from 'md5'\r\nimport ARow from \"ant-design-vue/es/grid/Row\";\r\nimport ACol from \"ant-design-vue/es/grid/Col\";\r\nimport {timeFix} from '@/utils/util'\r\nimport {mapGetters} from 'vuex'\r\nimport {Button} from 'ant-design-vue'\r\nimport HeadInfo from '@/components/tools/HeadInfo'\r\nimport {Radar} from '@/components'\r\nimport {getMyPost, getMyLike} from '@/api/myInfo'\r\nimport {deleteTreehole} from '@/api/Treehole'\r\nimport AFormItem from \"ant-design-vue/es/form/FormItem\";\r\n\r\nexport default {\r\n    components: {\r\n        AFormItem,\r\n        ACol,\r\n        ARow,\r\n        PageView,\r\n        Radar,\r\n        STable,\r\n      },\r\n    data() {\r\n      return {\r\n        timeFix: timeFix(),\r\n        avatar: '',\r\n        user: {},\r\n        projects: [],\r\n        loading: true,\r\n        radarLoading: true,\r\n        activities: [],\r\n        teams: [],\r\n        old_password: '',\r\n        new_password: '',\r\n        form: this.$form.createForm(this),\r\n        showPasswordForm: false,\r\n        new_identity: {\r\n          id: '',\r\n          newPassword: '',\r\n        },\r\n        visible3: false,\r\n        postData: [],\r\n        likeData: [],\r\n        allPostData: [],\r\n        allLikeData: [],\r\n        totalPage1: '',\r\n        totalPage2: '',\r\n        current1: 1,\r\n        current2: 1,\r\n        loading: true,\r\n        radarLoading: true,\r\n        deleteInfo:'',\r\n        todelete:'',\r\n        confirmLoading: false,\r\n          //userInfo:this.$store.getters.userInfo,\r\n\r\n        tabList: [\r\n          {\r\n            key: 'tab1',\r\n            // tab: 'tab1',\r\n            scopedSlots: { tab: 'customRender' },\r\n          },\r\n          {\r\n            key: 'tab2',\r\n            tab: 'tab2',\r\n          },\r\n        ],\r\n        tabListNoTitle: [\r\n          {\r\n            key: '发帖',\r\n            tab: '发帖',\r\n          },\r\n          {\r\n            key: '收藏',\r\n            tab: '收藏',\r\n          },\r\n        ],\r\n        key: 'tab1',\r\n        noTitleKey: '发帖',\r\n      };\r\n    },\r\n    computed: {\r\n      userInfo() {\r\n        return this.$store.getters.userInfo\r\n      }\r\n    },\r\n    created() {\r\n      this.user = this.$store.getters.userInfo\r\n      this.avatar = this.userInfo.avatar\r\n    },\r\n    methods: {\r\n      ...mapGetters(['nickname', 'welcome']),\r\n      cancelModifyPassword() {\r\n        console.log('Cancel modify passsword')\r\n      },\r\n      modifyPassButton() {\r\n        this.showPasswordForm = true;\r\n      },\r\n      cancelModifyPassword() {\r\n        this.showPasswordForm = false;\r\n      },\r\n      handleSubmit(e) {\r\n        e.preventDefault()\r\n        this.form.validateFields((err, value) => {\r\n          if (!err) {\r\n            if (md5(value.old_password) === this.userInfo.password) {\r\n              this.new_identity.newPassword = md5(value.new_password)\r\n              this.new_identity.id = this.userInfo.id\r\n              console.log(this.new_identity)\r\n              modifyPassword(this.new_identity).then(() => {\r\n                this.$message.success('密码修改成功！')\r\n              })\r\n              console.log(\"Pass!\")\r\n            } else {\r\n              this.$message.error('旧密码输入错误！')\r\n              console.log(\"Failed!\")\r\n            }\r\n          }\r\n        })\r\n        this.showPasswordForm = false;\r\n      },\r\n      onClickCancel(){\r\n        this.visible3=false;\r\n      },\r\n      onChange1(current){\r\n        this.current1=current;\r\n          getMyPost({id:1750000,page:(this.current1-1)}).then((response)=>{\r\n              console.log(response);\r\n              console.log(this.page);\r\n              this.allPostData=response.data;\r\n              this.postData=this.allPostData.list;\r\n              this.totalPage1=this.allPostData.total\r\n\r\n          })\r\n     },\r\n     onChange2(current){\r\n        this.current2=current;\r\n        getMyLike(this.current2).then((response)=>{\r\n          console.log(response);\r\n          console.log(this.page);\r\n          this.allLikeData=response.data;\r\n          this.likeData=this.allLikeData.likeData;\r\n          this.totalPage2=this.allLikeData.total //总页数\r\n      })\r\n     },\r\n     onClickDelete (id) {\r\n        console.log(id)\r\n        this.todelete = id\r\n        this.visible3 = true;\r\n      },\r\n      onClickDeleteRow () {\r\n        this.visible3 = false\r\n        deleteTreehole(this.todelete).then((response) => {\r\n        this.deleteInfo = response.info\r\n        if(this.deleteInfo === 'ok'){\r\n          this.sfData = [...response.data]\r\n          this.sfDataShow = this.sfData\r\n          this.$notification.open({\r\n          message: '删除成功',\r\n          description: '本条发帖信息删除成功',\r\n          icon: <a-icon type=\"check\" style=\"color: #108ee9\" />,\r\n        });\r\n        }\r\n        else{\r\n          this.$notification.open({\r\n          message: '删除失败',\r\n          description: '本条发帖信息删除失败',\r\n          icon: <a-icon type=\"warning\" style=\"color: #108ee9\" />,\r\n        });\r\n        }\r\n      })\r\n      },\r\n    },\r\n    mounted(){\r\n      console.log(this.$store.getters.userInfo)\r\n      getMyPost({id:1750000,page:(this.current1-1)}).then((response)=>{\r\n        console.log(response);\r\n        console.log(this.page);\r\n        this.allPostData=response.data;\r\n        this.postData=this.allPostData.list;\r\n        this.totalPage1=this.allPostData.total\r\n\r\n      }),\r\n      getMyLike({id:userInfo.id,page:(this.current2-1)}).then((response)=>{\r\n        console.log(response);\r\n        console.log(this.page);\r\n        this.allLikeData=response.data;\r\n        this.likeData=this.allLikeData.likeData;\r\n        this.totalPage2=this.allLikeData.totalPage //总页数\r\n      })\r\n    }\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.addButton{\r\n    position: absolute;\r\n    z-index: 999;\r\n    right:1em;\r\n    top:0em;\r\n  }\r\n</style>"]}]}