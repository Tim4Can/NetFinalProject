{"remainingRequest":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\src\\views\\equipment\\EquipmentPreview.vue?vue&type=style&index=0&id=05557616&lang=less&scoped=true&","dependencies":[{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\src\\views\\equipment\\EquipmentPreview.vue","mtime":1589903405530},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\css-loader\\index.js","mtime":1589903383310},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1589903404207},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\postcss-loader\\src\\index.js","mtime":1589903395815},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\less-loader\\dist\\cjs.js","mtime":1589903392905},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1589903381409},{"path":"D:\\Death in TJU\\Junior_2nd\\专项综合\\Project\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1589903404205}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n@import '~ant-design-vue/lib/style/themes/default.less';\r\n.button-group {\r\n  margin-bottom: 1rem;\r\n  .button {\r\n    margin-left: 0.5rem;\r\n    margin-left: 0.5rem;\r\n  }\r\n}\r\n.ant-form-inline .ant-form-item {\r\n  display: inline-block;\r\n  margin-right: 0;\r\n}\r\n",{"version":3,"sources":["EquipmentPreview.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4bA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EquipmentPreview.vue","sourceRoot":"src/views/equipment","sourcesContent":["<template>\r\n  <page-view title=\"仓储器材\">\r\n    <div>\r\n      <a-card :bordered=\"false\">\r\n        <a-form class=\"ant-advanced-search-form\" :form=\"form\" inline>\r\n          <a-row :gutter=\"24\">\r\n            <a-col :md=\"6\" :sm=\"24\">\r\n              <a-form-item :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\" label=\"器材编号：\">\r\n                <a-input placeholder=\"请输入器材编号\" v-model=\"inputID\" />\r\n              </a-form-item>\r\n            </a-col>\r\n            <a-col :md=\"6\" :sm=\"24\">\r\n              <a-form-item :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\" label=\"出厂时间：\">\r\n                <a-input placeholder=\"请输入出厂时间\" v-model=\"inputTime\" />\r\n              </a-form-item>\r\n            </a-col>\r\n            <a-col style=\"text-align: right\">\r\n              <a-button style=\"margin-right: 1rem\" @click=\"reload()\" type=\"primary\" icon=\"reload\">刷新</a-button>\r\n              <a-button @click=\"addEquipment\" type=\"primary\" icon=\"plus\">添加器材</a-button>\r\n            </a-col>\r\n          </a-row>\r\n        </a-form>\r\n        <br />\r\n        <a-table :columns=\"columns\" :dataSource=\"eDataShow\" rowKey=\"id\" bordered>\r\n          <template v-for=\"col in ['id']\" :slot=\"col\" slot-scope=\"text\">{{text}}</template>\r\n          <template slot=\"status\" slot-scope=\"text\">\r\n            <a-badge :status=\"text | statusTypeFilter\" :text=\"text | statusFilter\" />\r\n          </template>\r\n          <template slot=\"price\" slot-scope=\"text\">{{\"￥\" + text}}</template>\r\n          <template slot=\"icon\" slot-scope=\"text\">\r\n            <div id=\"app\">\r\n              <div class>\r\n                <div class=\"pic\" @click=\"() => showImg(text)\">\r\n                  <a-avatar :src=\"text\" />\r\n                </div>\r\n              </div>\r\n              <vue-easy-lightbox :visible=\"visible\" :imgs=\"src\" @hide=\"handleHide\"></vue-easy-lightbox>\r\n            </div>\r\n          </template>\r\n        </a-table>\r\n        <a-modal v-model=\"showAddForm\" footer>\r\n          <a-form title=\"添加器材\" @submit=\"handleSubmit\" :form=\"form\">\r\n            <a-form-item :wrapperCol=\"{ span: 24 }\" style=\"text-align: center\">\r\n              <h3>新建器材</h3>\r\n            </a-form-item>\r\n            <a-form-item\r\n              label=\"名称\"\r\n              :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n              :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\"\r\n            >\r\n              <a-select\r\n                v-decorator=\"[\r\n          'name',\r\n          {rules: [{ required: true, message: '请选择器材名称' }]}\r\n        ]\"\r\n                placeholder=\"请选择器材名称\"\r\n              >\r\n                <a-select-option\r\n                  v-for=\"(item,index) in this.allEquipType\"\r\n                  :key=\"index\"\r\n                  :value=\"item\"\r\n                >{{item}}</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n            <a-form-item\r\n              label=\"出厂日期\"\r\n              :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n              :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\"\r\n            >\r\n              <a-date-picker\r\n                name=\"productTime\"\r\n                style=\"width: 100%\"\r\n                format=\"YYYY.MM.DD\"\r\n                v-decorator=\"[\r\n            'productTime',\r\n            {rules: [{ required: true, message: '请选择出厂日期' }]}\r\n          ]\"\r\n              />\r\n            </a-form-item>\r\n            <a-form-item\r\n              label=\"器材型号\"\r\n              :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n              :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\"\r\n            >\r\n              <a-input\r\n                v-decorator=\"[\r\n            'model',\r\n            {rules: [{ required: true, message: '请输入器材型号' }]}\r\n          ]\"\r\n                name=\"model\"\r\n                placeholder=\"输入器材型号\"\r\n              />\r\n            </a-form-item>\r\n            <a-form-item\r\n              label=\"仓库\"\r\n              :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n              :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\"\r\n            >\r\n              <a-select\r\n                v-decorator=\"[\r\n          'warehouse',\r\n          {rules: [{ required: true, message: '请选择所属仓库' }]}\r\n        ]\"\r\n                placeholder=\"请选择所属仓库\"\r\n              >\r\n                <a-select-option\r\n                  v-for=\"(item,index) in this.allWarehouse\"\r\n                  :key=\"index\"\r\n                  :value=\"item\"\r\n                >{{item}}</a-select-option>\r\n              </a-select>\r\n            </a-form-item>\r\n\r\n            <a-form-item :wrapperCol=\"{ span: 24 }\" style=\"text-align: center\">\r\n              <a-button htmlType=\"submit\" type=\"primary\">提交</a-button>\r\n              <a-button style=\"margin-left: 8px\" @click=\"cancelAddForm\">取消</a-button>\r\n            </a-form-item>\r\n          </a-form>\r\n        </a-modal>\r\n      </a-card>\r\n    </div>\r\n  </page-view>\r\n</template>\r\n\r\n<script>\r\nimport { getEquipmentStoredList, getAllEquipmentType, addEquipmentStored } from '@/api/equipment'\r\nimport { getWarehouseName } from '@/api/accessory'\r\nimport { PageView } from '@/layouts'\r\nimport Fuse from 'fuse.js'\r\nimport Vue from 'vue'\r\nimport Lightbox from 'vue-easy-lightbox'\r\nimport moment from 'moment'\r\nimport ACol from 'ant-design-vue/es/grid/Col'\r\nVue.use(Lightbox)\r\n\r\nfunction showDate(time) {\r\n  var Times = new Array()\r\n  Times = time.split(' ')\r\n  date = Times[0]\r\n  for (i = 0; i < date.length; i++) {\r\n    if (date[i] === '-') {\r\n      date[i] = '.'\r\n    }\r\n  }\r\n}\r\nconst statusMap = {\r\n  0: {\r\n    status: 'success',\r\n    text: '全新'\r\n  },\r\n  1: {\r\n    status: 'error',\r\n    text: '报废'\r\n  }\r\n}\r\nconst columns = [\r\n  {\r\n    title: '器材编号',\r\n    dataIndex: 'id',\r\n    align: 'center',\r\n    width: '12%',\r\n    scopedSlots: { customRender: 'id' },\r\n    sorter: (a, b) => parseInt(a.id.toString().slice(2)) - parseInt(b.id.toString().slice(2))\r\n  },\r\n  {\r\n    title: '名称',\r\n    dataIndex: 'name',\r\n    align: 'center',\r\n    width: '10%',\r\n    scopedSlots: { customRender: 'name' }\r\n  },\r\n  {\r\n    title: '图标',\r\n    dataIndex: 'icon',\r\n    align: 'center',\r\n    width: '7%',\r\n    scopedSlots: { customRender: 'icon' }\r\n  },\r\n  {\r\n    title: '出厂时间',\r\n    dataIndex: 'productTime',\r\n    align: 'center',\r\n    width: '18%',\r\n    scopedSlots: { customRender: 'productTime' },\r\n    sorter: (a, b) => a.productTime > b.productTime\r\n  },\r\n  {\r\n    title: '状态',\r\n    dataIndex: 'status',\r\n    align: 'center',\r\n    width: '12%',\r\n    filters: [\r\n      {\r\n        text: '全新',\r\n        value: '0'\r\n      },\r\n      {\r\n        text: '报废',\r\n        value: '1'\r\n      }\r\n    ],\r\n    onFilter: (value, record) => record.status.indexOf(value) === 0,\r\n    scopedSlots: { customRender: 'status' }\r\n  },\r\n  {\r\n    title: '型号编号',\r\n    dataIndex: 'model',\r\n    align: 'center',\r\n    width: '12%',\r\n    scopedSlots: { customRender: 'model' }\r\n  },\r\n  {\r\n    title: '价格',\r\n    dataIndex: 'price',\r\n    align: 'center',\r\n    width: '8%',\r\n    scopedSlots: { customRender: 'price' },\r\n    sorter: (a, b) => a.price - b.price\r\n  },\r\n  {\r\n    title: '所在仓库',\r\n    dataIndex: 'warehouse',\r\n    align: 'center',\r\n    width: '14%',\r\n    scopedSlots: { customRender: 'storehouse' },\r\n    filters: [],\r\n    onFilter: (value, record) => record.warehouse.indexOf(value) === 0\r\n  }\r\n]\r\n// data\r\nlet inputID = ''\r\nconst eData = []\r\nconst eDataShow = []\r\nexport default {\r\n  inject: ['reload'],\r\n  name: 'EquipPreview',\r\n  components: {\r\n    ACol,\r\n    PageView\r\n  },\r\n  data() {\r\n    this.cacheData = eData.map(item => ({ ...item }))\r\n    return {\r\n      labelCol: {\r\n        xs: { span: 24 },\r\n        sm: { span: 8 }\r\n      },\r\n      wrapperCol: {\r\n        xs: { span: 24 },\r\n        sm: { span: 15 }\r\n      },\r\n      equipmentData: {\r\n        id: '',\r\n        name: '',\r\n        productTime: '',\r\n        status: '',\r\n        model: '',\r\n        price: '',\r\n        count: '',\r\n        warehouse: ''\r\n      },\r\n      allWarehouse: [],\r\n      allEquipType: [],\r\n      visible: false,\r\n      visible2: false,\r\n      src: '',\r\n      eData,\r\n      columns,\r\n      eDataShow,\r\n      inputID: '',\r\n      inputTime: '',\r\n      advanced: false,\r\n      form: this.$form.createForm(this),\r\n      showAddForm: false,\r\n      newFormCount: 0,\r\n      newFormWarehouse: ''\r\n    }\r\n  },\r\n  computed: {\r\n    emptyInput() {\r\n      if (\r\n        this.equipmentData.id !== '' ||\r\n        this.equipmentData.name !== '' ||\r\n        this.equipmentData.model !== '' ||\r\n        this.equipmentData.price !== '' ||\r\n        this.equipmentData.count !== '' ||\r\n        this.equipmentData.warehouse !== ''\r\n      ) {\r\n        return false\r\n      } else {\r\n        return true\r\n      }\r\n    }\r\n  },\r\n  // watch for fuzzy search\r\n  methods: {\r\n    moment,\r\n    onClickClearSelect() {\r\n      this.equipmentData.id = ''\r\n      this.equipmentData.name = ''\r\n      this.equipmentData.model = ''\r\n      this.equipmentData.price = ''\r\n      this.equipmentData.count = ''\r\n      this.equipmentData.warehouse = ''\r\n    },\r\n    onClickSubmit() {\r\n      this.onClickClearSelect()\r\n    },\r\n    handleChange(value, key, column) {\r\n      const newData = [...this.eData]\r\n      const target = newData.filter(item => key === item.key)[0]\r\n      if (target) {\r\n        target[column] = value\r\n        this.eData = newData\r\n      }\r\n    },\r\n    edit(key) {\r\n      const newData = [...this.eData]\r\n      const target = newData.filter(item => key === item.key)[0]\r\n      if (target) {\r\n        target.editable = true\r\n        this.eData = newData\r\n      }\r\n    },\r\n    save(key) {\r\n      const newData = [...this.eData]\r\n      const target = newData.filter(item => key === item.key)[0]\r\n      if (target) {\r\n        delete target.editable\r\n        this.eData = newData\r\n        this.cacheData = newData.map(item => ({ ...item }))\r\n      }\r\n    },\r\n    cancel(key) {\r\n      const newData = [...this.eData]\r\n      const target = newData.filter(item => key === item.key)[0]\r\n      if (target) {\r\n        Object.assign(target, this.cacheData.filter(item => key === item.key)[0])\r\n        delete target.editable\r\n        this.eData = newData\r\n      }\r\n    },\r\n    toggleAdvanced() {\r\n      this.advanced = !this.advanced\r\n    },\r\n    addEquipment() {\r\n      this.showAddForm = true\r\n    },\r\n    handleSubmit(e) {\r\n      e.preventDefault()\r\n      this.form.validateFields((err, value) => {\r\n        if (!err) {\r\n          value['productTime'] = value['productTime'].format('YYYY.MM.DD')\r\n          addEquipmentStored(value)\r\n            .then(response => {\r\n              this.eData = [...response.data]\r\n              this.eDataShow = this.eData\r\n              this.$notification.open({\r\n                message: '添加成功',\r\n                description: '请继续您的操作',\r\n                icon: <a-icon type=\"exclamation-circle\" style=\"color: blue\" />\r\n              })\r\n            })\r\n            .catch(err => {\r\n              this.$notification.open({\r\n                message: '添加失败',\r\n                description: '请查看控制台信息',\r\n                icon: <a-icon type=\"exclamation-circle\" style=\"color: #108ee9\" />\r\n              })\r\n              console.log(err)\r\n            })\r\n        }\r\n      })\r\n      this.showAddForm = false\r\n    },\r\n    cancelAddForm() {\r\n      this.showAddForm = false\r\n    },\r\n    showImg(text) {\r\n      this.visible = true\r\n      this.src = text\r\n    },\r\n    handleHide() {\r\n      this.visible = false\r\n    }\r\n  },\r\n  filters: {\r\n    statusFilter(type) {\r\n      return statusMap[type].text\r\n    },\r\n    statusTypeFilter(type) {\r\n      return statusMap[type].status\r\n    }\r\n  },\r\n  watch: {\r\n    inputID(pattern) {\r\n      if (pattern == '') {\r\n        this.eDataShow = this.eData\r\n      } else {\r\n        const option = {\r\n          keys: ['id'],\r\n          threshold: 0.1\r\n        }\r\n        var fuse = new Fuse(this.eData, option)\r\n        this.eDataShow = fuse.search(pattern)\r\n      }\r\n    },\r\n    inputTime(pattern) {\r\n      if (pattern == '') {\r\n        this.eDataShow = this.eData\r\n      } else {\r\n        const option = {\r\n          keys: ['productTime'],\r\n          threshold: 0.1\r\n        }\r\n        var fuse = new Fuse(this.eData, option)\r\n        this.eDataShow = fuse.search(pattern)\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    getEquipmentStoredList().then(response => {\r\n      this.eData = [...response.data]\r\n      this.eDataShow = this.eData\r\n    }),\r\n      getWarehouseName().then(response => {\r\n        this.allWarehouse = [...response.data]\r\n        this.columns[7].filters = []\r\n        for (let val of this.allWarehouse) {\r\n          let temp = {\r\n            text: val,\r\n            value: val\r\n          }\r\n          this.columns[7].filters.push(temp)\r\n        }\r\n      }),\r\n      getAllEquipmentType().then(response => {\r\n        this.allEquipType = [...response.data]\r\n      })\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import '~ant-design-vue/lib/style/themes/default.less';\r\n.button-group {\r\n  margin-bottom: 1rem;\r\n  .button {\r\n    margin-left: 0.5rem;\r\n    margin-left: 0.5rem;\r\n  }\r\n}\r\n.ant-form-inline .ant-form-item {\r\n  display: inline-block;\r\n  margin-right: 0;\r\n}\r\n</style>"]}]}